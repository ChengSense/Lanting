!function(){"use strict";var e=document.createElement("canvas"),t=e.getContext("2d");function i(i,o){window.devicePixelRatio&&(e.style.width=T+"px",e.style.height=k+"px",e.width=W.width,e.height=W.height,t.scale(window.devicePixelRatio,window.devicePixelRatio)),function(e,i){g(t,{strokeStyle:"#d0d3d7",lineCap:"butt"}),function(e,i){var o=-1;t.beginPath();for(;++o<i.length;){var n=i[o];t.moveTo(n.x,n.y),t.lineTo(n.x,n.height+.5),0<o&&(t.fillStyle="#f7f7f7",t.fillRect(n.x,0,n.width,n.height),t.fillStyle="black",t.fillText(n.text,n.x+3,n.y+15))}t.stroke()}(0,i)}(0,o)}var o=document.createElement("canvas"),n=o.getContext("2d");function a(e,t){window.devicePixelRatio&&(o.style.width=T+"px",o.style.height=k+"px",o.width=W.width,o.height=W.height,n.scale(window.devicePixelRatio,window.devicePixelRatio)),function(e,t){g(n,{strokeStyle:"#d0d3d7",lineCap:"butt"}),function(e,t){var i=-1,o=-1;n.beginPath();for(;++i<e.length;){var a=e[i][0];n.moveTo(a.x,a.y),n.lineTo(T+.5,a.y),0<i&&(n.fillStyle="#f7f7f7",n.fillRect(0,a.y,a.width,a.height))}for(;++o<t.length;){var a=t[o];n.moveTo(a.x,.5),n.lineTo(a.x,k+.5),0<o&&(n.fillStyle="#f7f7f7",n.fillRect(a.x,0,a.width,a.height))}n.stroke()}(e,t),i(0,t),function(e,t){window.devicePixelRatio&&(w.style.width=T+"px",w.style.height=k+"px",w.width=W.width,w.height=W.height,y.scale(window.devicePixelRatio,window.devicePixelRatio));!function(e,t){g(y,{strokeStyle:"#d0d3d7",lineCap:"butt"}),function(e,t){var i=-1;y.beginPath();for(;++i<e.length;){var o=e[i][0];y.moveTo(o.x,o.y),y.lineTo(o.width+.5,o.y),0<i&&(y.fillStyle="#f7f7f7",y.fillRect(0,o.y,o.width,o.height),y.fillStyle="black",y.fillText(o.text,o.x+3,o.y+15))}y.stroke()}(e)}(e)}(e)}(e,t)}var r=document.createElement("canvas"),f=r.getContext("2d");function s(e){window.devicePixelRatio&&(r.style.width=T+"px",r.style.height=k+"px",r.width=W.width,r.height=W.height,f.scale(window.devicePixelRatio,window.devicePixelRatio)),function(e){g(f,{font:"14px Arial"}),t=e,t.forEach(function(e){e.forEach(function(e){f.fillText(e.text,e.x+3,e.y+15)})});var t}(e)}var h={line:function(e,t,i){e.moveTo(t.x,t.y),e.lineTo(i.x,i.y)},area:function(e,t){h.render(),D.fillStyle="#e3edf9",D.fillRect(e.x-parseInt(c.x),e.y-parseInt(c.y),t.x-e.x+t.width,t.y-e.y+t.height),D.strokeStyle="#006dff",D.lineWidth=1.5,D.rect(e.x-parseInt(c.x),e.y-parseInt(c.y),t.x-e.x+t.width,t.y-e.y+t.height),D.globalCompositeOperation="source-over",D.stroke()},render:function(){D.beginPath(),D.clearRect(0,0,T,k),D.drawImage(o,-parseInt(c.x),-parseInt(c.y),T,k),D.drawImage(r,-parseInt(c.x),-parseInt(c.y),T,k),D.globalCompositeOperation="source-over",D.drawImage(e,-parseInt(c.x),0,T,k),D.drawImage(w,0,-parseInt(c.y),T,k),D.globalCompositeOperation="destination-over",D.stroke()},border:function(e){h.render(),D.beginPath(),D.strokeStyle="#006dff",D.lineWidth=1.5,D.rect(e.x-parseInt(c.x),e.y-parseInt(c.y),e.width,e.height),D.globalCompositeOperation="source-over",D.stroke()}},c={x:.5,y:.5};function u(){var e,t,i,o,n=$(".sm-sheet-scrollbar-horizontal"),a=$(document);function r(a){var r=parseInt(a.pageX-e);r<0&&(r=0),n.offset({left:r}),function(e){var n=d(e=parseInt(o*e),t);if(i==n)return;c.x=n.x,h.render(),i=n}(r)}function f(){a.off("mousemove",r).off("mouseup",f)}n.mousedown(function(s){if(!(i=d(s.pageX,s.pageY)))return;a.mousemove(r).mouseup(f),h=S[0],c=h[h.length-1],o=(c.x+c.width-T)/(T-n.width()),e=s.offsetX,t=s.pageY;var h,c})}function l(){var e,t,i,o,n=$(".sm-sheet-scrollbar-vertical"),a=$(document);function r(a){var r=a.pageY-t;r<0&&(r=0),n.offset({top:r}),function(t){t=parseInt(o*t);var n=d(e,t);if(i==n)return;c.y=n.y,h.render(),i=n}(r)}function f(){a.off("mousemove",r).off("mouseup",f)}n.mousedown(function(s){if(!(i=d(s.pageX,s.pageY)))return;a.mousemove(r).mouseup(f),h=S[S.length-1][0],o=(h.y+h.height-k)/(k-n.height()),e=s.pageX,t=s.offsetY;var h})}function d(e,t){for(;0<=t;t--){var i=I[t];if(i)for(;0<=e;e--){var o=i[e];if(o)return o}}}function x(e,t,i){e=parseInt(e),t=parseInt(t);var o=I[t]||{};I[t]=o,o[e]=i}function v(e){var t=e.id.split(":");return{x:t[1],y:t[0]}}function g(e,t){for(var i in t)e[i]=t[i];return e}function p(e){var t,i;return e.layerX||0==e.layerX?(t=e.layerX,i=e.layerY):(e.offsetX||0==e.offsetX)&&(t=e.offsetX,i=e.offsetY),{x:t+parseInt(c.x),y:i+parseInt(c.y)}}var w=document.createElement("canvas"),y=w.getContext("2d"),m=120,b=30;var I={},R={data:function(e,t){e=e||50,t=t||50;for(var i=-1,o=.5,n=[];++i<e;){for(var a=-1,r=.5,f=[];++a<t;)f.push(P(i,a,r,o,m,b)),r+=m;n.push(f),o+=b}return n},resetData:function(e){I={};var t=.5;return e.forEach(function(e){var i,o=.5;e.forEach(function(e){i=e,e.x=o,e.y=t,x(o,t,i),o+=e.width}),t+=i.height}),e},resetWidth:function(e,t,i){var o=v(t).x;e.forEach(function(e){var t=e[o];t.width=t.width+i})},resetHeight:function(e,t,i){e[v(t).y].forEach(function(e){e.height=e.height+i})},title:function(){var e=[""].concat(O);return O.forEach(function(t){O.forEach(function(i){e.push(""+t+i)})}),e}};function P(e,t,i,o,n,a){var r,f=R.title();return x(i,o,r=0<e&&0==t?{id:e+":"+t,x:i,y:o,width:n,height:a,text:e}:0<t&&0==e?{id:e+":"+t,x:i,y:o,width:n,height:a,text:f[t]}:0==e&&0==t?{id:e+":"+t,x:i,y:o,width:n,height:a,text:""}:{id:e+":"+t,x:i,y:o,width:n,height:a,text:e+":"+t}),r}function X(){var e,t,i,o=$(".split-vertical"),n=$("canvas"),a=$(document);function r(t){a.mouseup(f),n.off("mousedown",r),o.show();var s=d(t.pageX,t.pageY);Math.abs(s.x+s.width-t.pageX)<8?e=(i=s).x+i.width:Math.abs(s.x-t.pageX)<8&&(i=function(e){var t=v(e);return S[t.y][t.x-1]}(s),e=i.x+i.width)}function f(t){if(i){a.off("mouseup",f);var n=parseInt(t.pageX-e);R.resetWidth(S,i,n),R.resetData(S),o.hide(),H(),i=null}}n.mousemove(function(e){if(i)return o.css({left:e.pageX,top:0});var a=d(e.pageX,e.pageY);if(a)if(Math.abs(a.x+a.width-e.pageX)<8&&0==v(a).y){if(n.css({cursor:"col-resize"}),t)return;n.mousedown(r),t=a}else if(Math.abs(a.x-e.pageX)<8&&0==v(a).y){if(n.css({cursor:"col-resize"}),t)return;n.mousedown(r),t=a}else 0<v(a).x&&(n.css({cursor:"default"}),n.off("mousedown",r),t=null)})}function Y(){var e,t,i,o=$(".split-horizontal"),n=$("canvas"),a=$(document);function r(t){n.off("mousedown",r),a.mouseup(f),o.show();var s=d(t.pageX,t.pageY);Math.abs(s.y+s.height-t.pageY)<8?e=(i=s).y+i.height:Math.abs(s.y-t.pageY)<8&&(i=function(e){var t=v(e);return S[t.y-1][t.x]}(s),e=i.y+i.height)}function f(t){if(i){a.off("mouseup",f);var n=parseInt(t.pageY-e);R.resetHeight(S,i,n),R.resetData(S),o.hide(),H(),i=null}}n.mousemove(function(e){if(i)return o.css({left:0,top:e.pageY});var a=d(e.pageX,e.pageY);if(a)if(Math.abs(a.y+a.height-e.pageY)<8&&0==v(a).x){if(n.css({cursor:"row-resize"}),t)return;n.mousedown(r),t=a}else if(Math.abs(a.y-e.pageY)<8&&0==v(a).x){if(n.css({cursor:"row-resize"}),t)return;n.mousedown(r),t=a}else 0<v(a).y&&(n.css({cursor:"default"}),n.off("mousedown",r),t=null)})}var T,k,S,C=$("canvas"),E=$("textarea");function M(){!function(){var e,t;function i(i){var o=p(i),n=d(o.x,o.y);t!=n&&(h.area(e,n),t=n)}C.mousedown(function(o){E.hide();var n=p(o);(e=t=d(n.x,n.y))&&0<v(t).x&&0<v(t).y&&(h.border(e),C.mousemove(i))}).mouseup(function(e){C.off("mousemove",i),E.off("change")}).dblclick(z)}(),u(),l(),X(),Y()}function z(e){var t=p(e),i=d(t.x,t.y);!function(e){var t=e.y+C.position().top,i=e.x+C.position().left;E.show().focus(),E.css({left:i-c.x+2,top:t-c.y+2,width:e.width-6,height:e.height-6}),E.val(e.text)}(i),function(e){E.change(function(){e.text=this.value,function(e){f.clearRect(e.x,e.y,e.width,e.height),f.fillText(e.text,e.x+3,e.y+15)}(e),h.render()})}(i)}var O=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],W=document.querySelector("#canvas"),D=W.getContext("2d");function H(){s(S),a(S,S[0]),h.render()}T=$(W).parent().width(),k=$(W).parent().height(),window.devicePixelRatio&&(W.style.width=T+"px",W.style.height=k+"px",W.width=T*window.devicePixelRatio,W.height=k*window.devicePixelRatio,D.scale(window.devicePixelRatio,window.devicePixelRatio),S=R.data(),H(),M())}();
